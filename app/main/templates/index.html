{% extends "heading.html" %}

{% block content %}
    {% if search_data %}
        <h2> Search results for: {{ search_data }} </h2>
        <br>
    {% endif %}
    <form action="{{ url_for('main.filter_posts', **request.args) }}" method = "post">
        {{ filter_form.hidden_tag() }}
        <p style="padding-left:5vw"> 
            {{ filter_form.filter.label }}
            <select name="filter" id="search-filter">
                <option value="nwst" {% if filter_value == 'nwst' %} selected {% endif %}>Newest</option>
                <option value="ldst" {% if filter_value == 'ldst' %} selected {% endif %}>Oldest</option>
                <option value="mslk" {% if filter_value == 'mslk' %} selected {% endif %}>Most Liked</option>
                <option value="msdk" {% if filter_value == 'msdk' %} selected {% endif %}>Most Disliked</option>
                <option value="mscm" {% if filter_value == 'mscm' %} selected {% endif %}>Most Commented</option>
            </select>
            {{ filter_form.submit(id="filter-submit", class="submit") }}
        </p>
    </form>
    {% for post in posts %}
    <div class="posts">
    <p class = "post">
        {% include '_post.html' %}
        </p>
        {% if current_user.is_authenticated %}
            <p class = "new_comment">
                {% include 'new_comment.html' %}
            </p>
        {% endif %}
        <div id="toggle-comments-field-{{post.id}}" style="display: none;">
            {% for comment in sorted_comments %}
                <p>
                    {% include '_comment.html' %}
                </p>
            {% endfor %}
        </div>              
    {% endfor %}
    {% if prev_url %}
        <a style="padding-left: 2vw;" href="{{ prev_url }}">Newer posts</a>
    {% endif %}
    {% if next_url %}
        <a style="padding-left: 2vw;" href="{{ next_url }}">Older posts</a>
    {% endif %}
    </div>
{% endblock %}
